<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Differences from js_of_ocaml | Why JavaScript?</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    
    <link rel="prev" href="./Roadmap.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="8.1"
        data-chapter-title="Differences from js_of_ocaml"
        data-filepath="Differences-from-js_of_ocaml.md"
        data-basepath="."
        data-revision="Mon May 23 2016 11:05:32 GMT-0400 (EDT)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Home
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
                
                    <a target="_blank" href="https:/bloomberg.github.io/bucklescript/js-demo">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Playground
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> Get Started</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="Installation.html">
            
                
                    <a href="./Installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Create-a-simple-example-with-NPM.html">
            
                
                    <a href="./Create-a-simple-example-with-NPM.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Create a simple example with NPM
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="NPM-Support.html">
            
                
                    <a href="./NPM-Support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        NPM Support
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> BuckleScript Basics</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="FAQ.html">
            
                
                    <a href="./FAQ.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        FAQ
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                
                    <a target="_blank" href="https:/ocaml.org/">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        About OCaml
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="Compiler-options.html">
            
                
                    <a href="./Compiler-options.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Compiler options
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="How-to-adapt-your-build-system.html">
            
                
                    <a href="./How-to-adapt-your-build-system.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        How to adapt your build system
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="Semantic-differences-from-other-backends.html">
            
                
                    <a href="./Semantic-differences-from-other-backends.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Semantic differences from other backends
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="JavaScript-target-versions.html">
            
                
                    <a href="./JavaScript-target-versions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        JavaScript target versions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" >
            
            <span><b>4.</b> BuckleScript Overview</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Compiler-overview.html">
            
                
                    <a href="./Compiler-overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Compiler overview
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> BuckleScript FFI</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="Curry-and-Uncurry-functions.html">
            
                
                    <a href="./Curry-and-Uncurry-functions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Curry and Uncurry functions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="JS-call-OCaml.html">
            
                
                    <a href="./JS-call-OCaml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        JS call OCaml
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="OCaml-call-JS.html">
            
                
                    <a href="./OCaml-call-JS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        OCaml call JS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="Runtime-representation.html">
            
                
                    <a href="./Runtime-representation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Runtime representation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="Experimental-support-of-typescript.html">
            
                
                    <a href="./Experimental-support-of-typescript.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Experimental support of typescript
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="Unsupported-IO-primitives.html">
            
                
                    <a href="./Unsupported-IO-primitives.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Unsupported IO primitives
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Contributions</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" >
            
                
                    <a target="_blank" href="https:/github.com/bloomberg/bucklescript">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Github Link
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="Dev-mode-How-to.html">
            
                
                    <a href="./Dev-mode-How-to.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Dev mode How to
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="Help-move-runtime-functions-from-OCaml-to-Javascript.html">
            
                
                    <a href="./Help-move-runtime-functions-from-OCaml-to-Javascript.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Help move runtime functions from OCaml to Javascript
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" >
            
            <span><b>7.</b> Roadmap</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="Roadmap.html">
            
                
                    <a href="./Roadmap.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Roadmap
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" >
            
            <span><b>8.</b> Comparisons</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="8.1" data-path="Differences-from-js_of_ocaml.html">
            
                
                    <a href="./Differences-from-js_of_ocaml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Differences from js_of_ocaml
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Why JavaScript?</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <p><a href="https://github.com/ocsigen/js_of_ocaml" target="_blank">js_of_ocaml</a> is a popular compiler which compiles OCaml&apos;s bytecode into JavaScript. It is the inspiration for this project, and has already been under development for several years and is ready for production. In comparison, BuckleScript, while moving fast, is still a very young project. BuckleScript&apos;s motivation, like <code>js_of_ocaml</code>, is to unify the ubiquity of the JavaScript platform and the truly sophisticated type system of OCaml, however, there are some areas where we view things differently from <code>js_of_ocaml</code>. We describe below, some of these differences, and also refer readers to some of the original informal <a href="https://github.com/ocsigen/js_of_ocaml/issues/338" target="_blank">discussions</a>.</p>
<h2 id="readable-output">Readable Output</h2>
<p>One of the main BuckleScript goal is to generate readable JavaScript code. From the start we believed developers using BuckleScript for JavaScript development will look at the generated code an order of magnitude more than an OCaml developer will look at the assembly one. Part of our intent is to make it easier for a JavaScript developer to transition to the OCaml language. Furthermore looking at existing transpilers for JavaScript:  <a href="http://coffeescript.org/" target="_blank">coffescript</a>, <a href="https://babeljs.io/" target="_blank">babel</a> and <a href="https://github.com/Microsoft/TypeScript" target="_blank">typescript</a>, the most widely adopted ones are the one that favors code readability.
The generated code by BuckleScript is pretty close to the JavaScript code one might write by hand, especially if you use mostly the language features which are shared between JavaScript and OCaml. Indeed if you use OCaml language constructs which are specific to OCaml the generated code will differ a lot more but should still be readable. Such examples includes complex pattern matching for which OCaml offers a succint and powerful syntax while JavaScript code will most likely results in nested <code>if</code>.  </p>
<p>One of the major use case we anticipate (especially at early stages of adoption) is that developers will use BuckleScript to implement a component of their JavaScript application (maybe do gradual replacement of modules). The main application will therefore still be JavaScript and we therefore believe readable output should improve that use case.</p>
<h2 id="runtime-representations--ffi">Runtime Representations &amp;&amp; FFI</h2>
<p><strong>Runtime Representation</strong></p>
<p><code>js_of_ocaml</code> runtime representation favors exact semantic to the native/byte compiler. One advantage is that it makes it easy to port existing OCaml libraries. The most notable difference is the string representation in <code>js_of_ocaml</code> is not a JavaScript string like in BuckleScript but rather a dedicated runtime structure. This allows <code>js_of_ocaml</code> to preserve the assumption that string are sequence of 8-bit integers.</p>
<p>BuckleScript runtime representation is closer to JavaScript. This is particularly helpful for both the ability to debug OCaml values in JavaScript but also when writing the FFI.</p>
<p>Some example of differences are:</p>
<ul>
<li><code>string</code> : In BuckleScript the string is represented as a JavaScript string while in <code>js_of_ocaml</code> it&apos;s a much more involved data structure. </li>
<li><code>array</code>: In BuckleScript the array has the same indexing as a JavaScript array while for <code>js_of_ocaml</code> the index starts at 1.  </li>
<li><code>tuple</code>: In BuckleScript the array has the same indexing as a JavaScript array while for <code>js_of_ocaml</code> the index starts at 1.</li>
</ul>
<p><strong>FFI</strong></p>
<p>Regarding the FFI, BuckleScript favors using only <a href="http://caml.inria.fr/pub/docs/manual-ocaml/extn.html#sec245" target="_blank">attributes</a>; one drawback that we plan to address on the future is that it lacks some expressiveness. </p>
<p><code>js_of_ocaml</code> introduces a very sophisticated and expressive syntax extension, which works great most of the time, but can sometimes generate confusing compiler errors. </p>
<p>The introduction of <a href="https://github.com/LexiFi/gen_js_api" target="_blank">gen_js_api</a> tool as an alternative FFI makes it easier to write FFI with <code>js_of_ocaml</code>. <code>gen_js_api</code> could be a nice way to implement FFIs to support both <code>BuckleScript</code> and <code>js_of_ocaml</code>.</p>
<p><strong>Runtime library</strong></p>
<p>BuckleScript runtime library is mostly implemented in OCaml while <code>js_of_ocaml</code> runtime is purely in JavaScript. The difference is actually significant since we believe it reflects how easy it is to write JavaScript code in OCaml using the BuckleScript model (FFI and Runtime representation).</p>
<h2 id="separate-compilation">Separate Compilation</h2>
<p>BuckleScript compiles one OCaml module into one Javascript module. This follows the modern JavaScript development and makes it easier to gradually use OCaml in an existing code base. This is particularly relevant for our use cases for which we plan to implement components in OCaml while the larger application is written in JavaScript. The JavaScript ecosystem also has plenty of tools and support for modules, making it easy and natural to integrate modules generated by BuckleScript. It also opens the door for supporting <a href="http://webpack.github.io/docs/hot-module-replacement.html" target="_blank">hot module replacement</a> in future.
The module compilation strategy allows more granular compilation and as consequence faster feedback loop during development. </p>
<p><code>js_of_ocaml</code> compiles a whole OCaml program in JavaScript. This makes it easier when the main application is written in OCaml but less natural when integrating OCaml as a component in a larger JavaScript application.</p>
<h2 id="integration-with-existing-ecosystems">Integration with existing ecosystems</h2>
<p>BuckleScript is aware of <code>npm</code> module paths and favor libraries development. In contrast with <code>js_of_ocaml</code>&apos; focus on developing executable. 
BuckleScript does not provide a whole program compilation mode out of the box; it rather delegates this to existing linker/bundler (such as webpack or Google Closure compiler).</p>
<p>When integrating code generated by BuckleScript developers only need to look at the <code>.mli</code> files. BuckleScript respect those interfaces and will only export the functions from the `.mli file. No special code needs to be added to expose OCaml code to the JavaScript.</p>
<p><code>js_of_ocaml</code> requires specific code to export functions OCaml code to the larger JavaScript application.</p>
<h2 id="intrusiveness">Intrusiveness</h2>
<p>The major advantage of <code>js_of_ocaml</code> is that it is non intrusive; you can reuse your existing project setup (build system) and simply convert the bytecode output to JavaScript output as a post-processing step. </p>
<p>With BuckleScript, however, users have to adapt their build system for existing OCaml code base. In BuckleScript, we traded intrusiveness for being able to extract more information from the code. </p>
<p>We think there&apos;s a need for both tools to exist simultaneously. If you have some OCaml code, and your primary motivation is that it should run inside a browser, then <code>js_of_ocaml</code> is a very good choice. However, if you target JavaScript (browser/Node.Js) as the primary backend for your application and care about the integration with the JavaScript environment then we believe BuckleScript can offer a better experience. We also think both projects can help and learn from each other.</p>
<h2 id="performance">Performance</h2>
<p>We have not conducted exhaustive benchmarks yet, however, our initial results show similar performance between <code>js_of_ocaml</code> and BuckleScript (using Google Closure simple optimization level).</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./Roadmap.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Roadmap"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"edit-link":{"base":"https://github.com/bloomberg/bucklescript/tree/master/docs","label":"Edit This Page"},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
